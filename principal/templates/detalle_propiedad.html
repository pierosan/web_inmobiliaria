{% extends 'base.html' %}
{% load static %}
{% load i18n %}
{% load l10n %}

{% block content %}

<!-- Galería principal de imágenes -->
<section class="prop-gallery-top">
  <div class="gallery-row container">
    {% for img in propiedad.imagenes.all %}
      <div class="gallery-item">
        <img src="{{ img.imagen_url }}" alt="{{ propiedad.nombre }}">
      </div>
    {% endfor %}
  </div>
</section>

<!-- Cabecera -->
<section class="prop-head container">
  <div class="prop-head-left">
    <h1 class="prop-title">{{ propiedad.nombre }}</h1>
    <p class="prop-address">
      <i class="fas fa-map-marker-alt"></i>
      {{ propiedad.direccion }}
    </p>
  </div>
  <div class="prop-head-right">
    <div class="prop-price">S/ {{ propiedad.precio|floatformat:3 }}</div>
  </div>
</section>

<!-- Descripción + resumen -->
<section class="prop-body container">
  <div class="prop-desc">
    <h3>Descripción</h3>
    <p>{{ propiedad.descripcion }}</p>
  </div>

  <aside class="prop-summary card">
    <h3>Resumen</h3>
    <div class="summary-grid">
      <div class="summary-item"><i class="fas fa-bed"></i><div><strong>{{ propiedad.dormitorios }}</strong><span>Dormitorios</span></div></div>
      <div class="summary-item"><i class="fas fa-bath"></i><div><strong>{{ propiedad.banos }}</strong><span>Baños</span></div></div>
      <div class="summary-item"><i class="fas fa-car"></i><div><strong>{{ propiedad.garaje }}</strong><span>Garaje</span></div></div>
      <div class="summary-item"><i class="fas fa-ruler-combined"></i><div><strong>{{ propiedad.area }} m²</strong><span>Área</span></div></div>
      <div class="summary-item"><i class="far fa-calendar-alt"></i><div><strong>{{ propiedad.anio }}</strong><span>Antigüedad (años)</span></div></div>
    </div>
  </aside>
</section>

<!-- Dirección + detalles -->
<section class="prop-info container">
  <div class="info-left card">
    <h3>Dirección del Inmueble</h3>
    <p><strong>Dirección:</strong> {{ propiedad.direccion }}</p>
    <p><strong>Ciudad:</strong> {{ propiedad.ciudad }}</p>
    <p><strong>Código Postal:</strong> {{ propiedad.cp }}</p>
    <a href="https://www.google.com/maps?q={{ propiedad.latitud|unlocalize }},{{ propiedad.longitud|unlocalize }}" target="_blank" class="btn-map">
      <i class="fas fa-map"></i> Abrir en Google Maps
    </a>
  </div>

  <div class="info-right card">
    <h3>Detalles de la Propiedad</h3>
    <ul>
      <li><strong>ID de Inmueble:</strong> {{ propiedad.id }}</li>
      <li><strong>Precio:</strong> S/ {{ propiedad.precio|floatformat:3 }}</li>
      <li><strong>Tamaño de la Propiedad:</strong> {{ propiedad.area }} m²</li>
      <li><strong>Tamaño del Lote:</strong> {{ propiedad.lote }} m²</li>
      <li><strong>Habitaciones:</strong> {{ propiedad.habitaciones }}</li>
      <li><strong>Dormitorios:</strong> {{ propiedad.dormitorios }}</li>
      <li><strong>Baños:</strong> {{ propiedad.banos }}</li>
      <li><strong>Año de Construcción:</strong> {{ propiedad.anio }}</li>
      <li><strong>Parqueos:</strong> {{ propiedad.garaje }}</li>
      <li><strong>Disponible desde:</strong> {{ propiedad.disponible }}</li>
      <li><strong>Antigüedad:</strong> {{ propiedad.antiguedad }}</li>
    </ul>
  </div>
</section>

<!-- Video -->
<section class="prop-video container">
  <h3>Video del Inmueble</h3>
  <div class="video-wrapper">
    <iframe
  width="100%" height="450"
  src="{{ propiedad.video }}"
  title="Video del inmueble"
  frameborder="0"
  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
  allowfullscreen
  referrerpolicy="strict-origin-when-cross-origin">
</iframe>

  </div>
</section>

<!-- Mapa -->
<section class="prop-map container">
  <h3>Ubicación en el mapa</h3>
  <div class="map-wrapper">
    <iframe width="425" height="350" src="https://www.openstreetmap.org/export/embed.html?bbox={{ propiedad.longitud|unlocalize }}%2C{{ propiedad.latitud|unlocalize }}%2C{{ propiedad.longitud|unlocalize }}%2C{{ propiedad.latitud|unlocalize }}&amp;layer=mapnik&amp;marker={{ propiedad.latitud|unlocalize }}%2C{{ propiedad.longitud|unlocalize }}" style="border: 1px solid black"></iframe>
  </div>
</section>

{% endblock %}
